{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{Container,Typography,Box,Card,CardContent,Grid,Button,TextField,Avatar,Paper,List,ListItem,ListItemAvatar,ListItemText,Badge,IconButton,Chip,Divider,Dialog,DialogTitle,DialogContent,DialogActions}from'@mui/material';import{Send as SendIcon,AttachFile as AttachFileIcon,EmojiEmotions as EmojiIcon,Search as SearchIcon,Add as AddIcon,MoreVert as MoreVertIcon,Phone as PhoneIcon,VideoCall as VideoCallIcon,Info as InfoIcon,SmartToy as AIIcon}from'@mui/icons-material';// 导入AI聊天组件\nimport AIConsultationChat from'../components/AIConsultationChat';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatPage=()=>{const[selectedRoom,setSelectedRoom]=useState(null);const[message,setMessage]=useState('');const[messages,setMessages]=useState([]);const[chatRooms,setChatRooms]=useState([]);const[aiChatOpen,setAiChatOpen]=useState(false);const[searchQuery,setSearchQuery]=useState('');const messagesEndRef=useRef(null);// 模拟聊天房间数据\nconst mockChatRooms=[{id:1,room_type:'private',other_user:{id:1,username:'alice_cs',full_name:'Alice Wang',avatar_url:'https://api.dicebear.com/7.x/avataaars/svg?seed=Alice',online_status:'online',last_seen:null},last_message:{content:'好的，我来帮你看看文书',sender_id:1,created_at:'2024-07-24T15:30:00Z'},unread_count:2,updated_at:'2024-07-24T15:30:00Z'},{id:2,room_type:'private',other_user:{id:2,username:'bob_finance',full_name:'Bob Chen',avatar_url:'https://api.dicebear.com/7.x/avataaars/svg?seed=Bob',online_status:'offline',last_seen:'2024-07-24T12:00:00Z'},last_message:{content:'面试准备的资料我发给你了',sender_id:2,created_at:'2024-07-24T10:15:00Z'},unread_count:0,updated_at:'2024-07-24T10:15:00Z'},{id:3,room_type:'private',other_user:{id:3,username:'carol_ai',full_name:'Carol Liu',avatar_url:'https://api.dicebear.com/7.x/avataaars/svg?seed=Carol',online_status:'away',last_seen:'2024-07-24T14:00:00Z'},last_message:{content:'申请材料看起来不错，有几个地方可以优化',sender_id:3,created_at:'2024-07-23T16:45:00Z'},unread_count:1,updated_at:'2024-07-23T16:45:00Z'}];// 模拟消息数据\nconst mockMessages={1:[{id:1,sender_id:1,content:'你好！看到你的申请需求了，我可以帮你看看文书',message_type:'text',created_at:'2024-07-24T15:25:00Z'},{id:2,sender_id:999,// 当前用户ID\ncontent:'太好了！我现在还在准备PS，想请你帮忙看看思路对不对',message_type:'text',created_at:'2024-07-24T15:28:00Z'},{id:3,sender_id:1,content:'好的，我来帮你看看文书。你可以把草稿发给我，我会详细批注',message_type:'text',created_at:'2024-07-24T15:30:00Z'},{id:4,sender_id:999,content:'谢谢！我马上整理一下发给你',message_type:'text',created_at:'2024-07-24T15:32:00Z'}],2:[{id:5,sender_id:2,content:'关于MBA面试，我给你准备了一些常见问题',message_type:'text',created_at:'2024-07-24T10:10:00Z'},{id:6,sender_id:2,content:'面试准备的资料我发给你了',message_type:'text',created_at:'2024-07-24T10:15:00Z'}],3:[{id:7,sender_id:3,content:'申请材料看起来不错，有几个地方可以优化',message_type:'text',created_at:'2024-07-23T16:45:00Z'}]};useEffect(()=>{setChatRooms(mockChatRooms);// 默认选择第一个聊天室\nif(mockChatRooms.length>0){setSelectedRoom(mockChatRooms[0]);setMessages(mockMessages[mockChatRooms[0].id]||[]);}},[]);useEffect(()=>{scrollToBottom();},[messages]);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};const handleRoomSelect=room=>{setSelectedRoom(room);setMessages(mockMessages[room.id]||[]);// 标记消息为已读\nsetChatRooms(prev=>prev.map(r=>r.id===room.id?{...r,unread_count:0}:r));};const handleSendMessage=()=>{if(!message.trim()||!selectedRoom)return;const newMessage={id:Date.now(),sender_id:999,// 当前用户ID\ncontent:message,message_type:'text',created_at:new Date().toISOString()};setMessages(prev=>[...prev,newMessage]);setMessage('');// 更新聊天室的最后消息\nsetChatRooms(prev=>prev.map(room=>room.id===selectedRoom.id?{...room,last_message:{content:message,sender_id:999,created_at:new Date().toISOString()},updated_at:new Date().toISOString()}:room));};const formatTime=dateString=>{const date=new Date(dateString);const now=new Date();const diffInMinutes=Math.floor((now-date)/(1000*60));if(diffInMinutes<1)return'刚刚';if(diffInMinutes<60)return`${diffInMinutes}分钟前`;if(diffInMinutes<1440)return`${Math.floor(diffInMinutes/60)}小时前`;return date.toLocaleDateString();};const getOnlineStatusColor=status=>{switch(status){case'online':return'success';case'away':return'warning';case'offline':return'error';default:return'default';}};const filteredRooms=chatRooms.filter(room=>room.other_user.full_name.toLowerCase().includes(searchQuery.toLowerCase())||room.other_user.username.toLowerCase().includes(searchQuery.toLowerCase()));return/*#__PURE__*/_jsxs(Container,{maxWidth:\"xl\",sx:{py:2,height:'100vh'},children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{height:'calc(100vh - 32px)'},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,lg:3,children:/*#__PURE__*/_jsxs(Card,{sx:{height:'100%',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsxs(Box,{sx:{p:2,borderBottom:1,borderColor:'divider'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"\\u6D88\\u606F\"}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(IconButton,{onClick:()=>setAiChatOpen(true),sx:{background:'linear-gradient(45deg, #ff6b6b, #ffa500)',color:'white',mr:1,'&:hover':{background:'linear-gradient(45deg, #ff5252, #ff9800)'}},size:\"small\",children:/*#__PURE__*/_jsx(AIIcon,{})}),/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(AddIcon,{})})]})]}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,size:\"small\",placeholder:\"\\u641C\\u7D22\\u8054\\u7CFB\\u4EBA...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),InputProps:{startAdornment:/*#__PURE__*/_jsx(SearchIcon,{sx:{color:'text.secondary',mr:1}})}})]}),/*#__PURE__*/_jsx(Box,{sx:{flex:1,overflow:'auto'},children:/*#__PURE__*/_jsx(List,{sx:{p:0},children:filteredRooms.map(room=>{var _room$last_message,_room$last_message2;return/*#__PURE__*/_jsxs(ListItem,{button:true,selected:(selectedRoom===null||selectedRoom===void 0?void 0:selectedRoom.id)===room.id,onClick:()=>handleRoomSelect(room),sx:{borderBottom:1,borderColor:'divider','&.Mui-selected':{backgroundColor:'primary.light','&:hover':{backgroundColor:'primary.light'}}},children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Badge,{color:getOnlineStatusColor(room.other_user.online_status),variant:\"dot\",invisible:room.other_user.online_status==='offline',anchorOrigin:{vertical:'bottom',horizontal:'right'},children:/*#__PURE__*/_jsx(Avatar,{src:room.other_user.avatar_url})})}),/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",noWrap:true,children:room.other_user.full_name}),room.unread_count>0&&/*#__PURE__*/_jsx(Badge,{badgeContent:room.unread_count,color:\"error\"})]}),secondary:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",noWrap:true,sx:{mb:0.5},children:((_room$last_message=room.last_message)===null||_room$last_message===void 0?void 0:_room$last_message.content)||'暂无消息'}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",children:formatTime(((_room$last_message2=room.last_message)===null||_room$last_message2===void 0?void 0:_room$last_message2.created_at)||room.updated_at)})]})})]},room.id);})})})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:8,lg:9,children:selectedRoom?/*#__PURE__*/_jsxs(Card,{sx:{height:'100%',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsx(Box,{sx:{p:2,borderBottom:1,borderColor:'divider'},children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:2},children:[/*#__PURE__*/_jsx(Badge,{color:getOnlineStatusColor(selectedRoom.other_user.online_status),variant:\"dot\",invisible:selectedRoom.other_user.online_status==='offline',children:/*#__PURE__*/_jsx(Avatar,{src:selectedRoom.other_user.avatar_url})}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:selectedRoom.other_user.full_name}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:selectedRoom.other_user.online_status==='online'?'在线':selectedRoom.other_user.online_status==='away'?'离开':`最后上线: ${formatTime(selectedRoom.other_user.last_seen)}`})]})]}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(PhoneIcon,{})}),/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(VideoCallIcon,{})}),/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(InfoIcon,{})}),/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(MoreVertIcon,{})})]})]})}),/*#__PURE__*/_jsxs(Box,{sx:{flex:1,overflow:'auto',p:1},children:[messages.map(msg=>/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:msg.sender_id===999?'flex-end':'flex-start',mb:1},children:/*#__PURE__*/_jsxs(Box,{sx:{maxWidth:'70%',display:'flex',flexDirection:msg.sender_id===999?'row-reverse':'row',alignItems:'flex-end',gap:1},children:[msg.sender_id!==999&&/*#__PURE__*/_jsx(Avatar,{src:selectedRoom.other_user.avatar_url,sx:{width:32,height:32}}),/*#__PURE__*/_jsxs(Paper,{sx:{p:1.5,backgroundColor:msg.sender_id===999?'primary.main':'grey.100',color:msg.sender_id===999?'white':'text.primary',borderRadius:2,borderBottomRightRadius:msg.sender_id===999?4:16,borderBottomLeftRadius:msg.sender_id===999?16:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:msg.content}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{display:'block',mt:0.5,opacity:0.7,fontSize:'0.75rem'},children:new Date(msg.created_at).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})})]})]})},msg.id)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(Box,{sx:{p:2,borderTop:1,borderColor:'divider'},children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1,alignItems:'flex-end'},children:[/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(AttachFileIcon,{})}),/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(EmojiIcon,{})}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,multiline:true,maxRows:4,placeholder:\"\\u8F93\\u5165\\u6D88\\u606F...\",value:message,onChange:e=>setMessage(e.target.value),onKeyPress:e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSendMessage();}},variant:\"outlined\",size:\"small\"}),/*#__PURE__*/_jsx(IconButton,{color:\"primary\",onClick:handleSendMessage,disabled:!message.trim(),children:/*#__PURE__*/_jsx(SendIcon,{})})]})})]}):/*#__PURE__*/_jsx(Card,{sx:{height:'100%',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"text.secondary\",gutterBottom:true,children:\"\\u9009\\u62E9\\u4E00\\u4E2A\\u5BF9\\u8BDD\\u5F00\\u59CB\\u804A\\u5929\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"\\u6216\\u8005\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(AIIcon,{}),onClick:()=>setAiChatOpen(true),sx:{mt:2,background:'linear-gradient(45deg, #ff6b6b, #ffa500)','&:hover':{background:'linear-gradient(45deg, #ff5252, #ff9800)'}},children:\"\\u4E0EAI\\u52A9\\u624B\\u804A\\u5929\"})]})})})]}),/*#__PURE__*/_jsxs(Dialog,{open:aiChatOpen,onClose:()=>setAiChatOpen(false),maxWidth:\"md\",fullWidth:true,PaperProps:{sx:{height:'80vh',borderRadius:3}},children:[/*#__PURE__*/_jsxs(DialogTitle,{sx:{background:'linear-gradient(45deg, #ff6b6b, #ffa500)',color:'white',display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(AIIcon,{}),\"AI\\u7559\\u5B66\\u54A8\\u8BE2\\u52A9\\u624B\"]}),/*#__PURE__*/_jsx(DialogContent,{sx:{p:0,height:'100%'},children:/*#__PURE__*/_jsx(AIConsultationChat,{})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:()=>setAiChatOpen(false),children:\"\\u5173\\u95ED\"})})]})]});};export default ChatPage;","map":{"version":3,"names":["React","useState","useEffect","useRef","Container","Typography","Box","Card","CardContent","Grid","Button","TextField","Avatar","Paper","List","ListItem","ListItemAvatar","ListItemText","Badge","IconButton","Chip","Divider","Dialog","DialogTitle","DialogContent","DialogActions","Send","SendIcon","AttachFile","AttachFileIcon","EmojiEmotions","EmojiIcon","Search","SearchIcon","Add","AddIcon","MoreVert","MoreVertIcon","Phone","PhoneIcon","VideoCall","VideoCallIcon","Info","InfoIcon","SmartToy","AIIcon","AIConsultationChat","jsx","_jsx","jsxs","_jsxs","ChatPage","selectedRoom","setSelectedRoom","message","setMessage","messages","setMessages","chatRooms","setChatRooms","aiChatOpen","setAiChatOpen","searchQuery","setSearchQuery","messagesEndRef","mockChatRooms","id","room_type","other_user","username","full_name","avatar_url","online_status","last_seen","last_message","content","sender_id","created_at","unread_count","updated_at","mockMessages","message_type","length","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleRoomSelect","room","prev","map","r","handleSendMessage","trim","newMessage","Date","now","toISOString","formatTime","dateString","date","diffInMinutes","Math","floor","toLocaleDateString","getOnlineStatusColor","status","filteredRooms","filter","toLowerCase","includes","maxWidth","sx","py","height","children","container","spacing","item","xs","md","lg","display","flexDirection","p","borderBottom","borderColor","justifyContent","alignItems","mb","variant","onClick","background","color","mr","size","fullWidth","placeholder","value","onChange","e","target","InputProps","startAdornment","flex","overflow","_room$last_message","_room$last_message2","button","selected","backgroundColor","invisible","anchorOrigin","vertical","horizontal","src","primary","noWrap","badgeContent","secondary","gap","msg","width","borderRadius","borderBottomRightRadius","borderBottomLeftRadius","mt","opacity","fontSize","toLocaleTimeString","hour","minute","ref","borderTop","multiline","maxRows","onKeyPress","key","shiftKey","preventDefault","disabled","textAlign","gutterBottom","startIcon","open","onClose","PaperProps"],"sources":["/data/qyu/projects/backend/frontend/src/pages/ChatPage.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport {\n  Container,\n  Typography,\n  Box,\n  Card,\n  CardContent,\n  Grid,\n  Button,\n  TextField,\n  Avatar,\n  Paper,\n  List,\n  ListItem,\n  ListItemAvatar,\n  ListItemText,\n  Badge,\n  IconButton,\n  Chip,\n  Divider,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n} from '@mui/material';\nimport {\n  Send as SendIcon,\n  AttachFile as AttachFileIcon,\n  EmojiEmotions as EmojiIcon,\n  Search as SearchIcon,\n  Add as AddIcon,\n  MoreVert as MoreVertIcon,\n  Phone as PhoneIcon,\n  VideoCall as VideoCallIcon,\n  Info as InfoIcon,\n  SmartToy as AIIcon,\n} from '@mui/icons-material';\n\n// 导入AI聊天组件\nimport AIConsultationChat from '../components/AIConsultationChat';\n\nconst ChatPage = () => {\n  const [selectedRoom, setSelectedRoom] = useState(null);\n  const [message, setMessage] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [chatRooms, setChatRooms] = useState([]);\n  const [aiChatOpen, setAiChatOpen] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const messagesEndRef = useRef(null);\n\n  // 模拟聊天房间数据\n  const mockChatRooms = [\n    {\n      id: 1,\n      room_type: 'private',\n      other_user: {\n        id: 1,\n        username: 'alice_cs',\n        full_name: 'Alice Wang',\n        avatar_url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Alice',\n        online_status: 'online',\n        last_seen: null\n      },\n      last_message: {\n        content: '好的，我来帮你看看文书',\n        sender_id: 1,\n        created_at: '2024-07-24T15:30:00Z'\n      },\n      unread_count: 2,\n      updated_at: '2024-07-24T15:30:00Z'\n    },\n    {\n      id: 2,\n      room_type: 'private',\n      other_user: {\n        id: 2,\n        username: 'bob_finance',\n        full_name: 'Bob Chen',\n        avatar_url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Bob',\n        online_status: 'offline',\n        last_seen: '2024-07-24T12:00:00Z'\n      },\n      last_message: {\n        content: '面试准备的资料我发给你了',\n        sender_id: 2,\n        created_at: '2024-07-24T10:15:00Z'\n      },\n      unread_count: 0,\n      updated_at: '2024-07-24T10:15:00Z'\n    },\n    {\n      id: 3,\n      room_type: 'private',\n      other_user: {\n        id: 3,\n        username: 'carol_ai',\n        full_name: 'Carol Liu',\n        avatar_url: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Carol',\n        online_status: 'away',\n        last_seen: '2024-07-24T14:00:00Z'\n      },\n      last_message: {\n        content: '申请材料看起来不错，有几个地方可以优化',\n        sender_id: 3,\n        created_at: '2024-07-23T16:45:00Z'\n      },\n      unread_count: 1,\n      updated_at: '2024-07-23T16:45:00Z'\n    }\n  ];\n\n  // 模拟消息数据\n  const mockMessages = {\n    1: [\n      {\n        id: 1,\n        sender_id: 1,\n        content: '你好！看到你的申请需求了，我可以帮你看看文书',\n        message_type: 'text',\n        created_at: '2024-07-24T15:25:00Z'\n      },\n      {\n        id: 2,\n        sender_id: 999, // 当前用户ID\n        content: '太好了！我现在还在准备PS，想请你帮忙看看思路对不对',\n        message_type: 'text',\n        created_at: '2024-07-24T15:28:00Z'\n      },\n      {\n        id: 3,\n        sender_id: 1,\n        content: '好的，我来帮你看看文书。你可以把草稿发给我，我会详细批注',\n        message_type: 'text',\n        created_at: '2024-07-24T15:30:00Z'\n      },\n      {\n        id: 4,\n        sender_id: 999,\n        content: '谢谢！我马上整理一下发给你',\n        message_type: 'text',\n        created_at: '2024-07-24T15:32:00Z'\n      }\n    ],\n    2: [\n      {\n        id: 5,\n        sender_id: 2,\n        content: '关于MBA面试，我给你准备了一些常见问题',\n        message_type: 'text',\n        created_at: '2024-07-24T10:10:00Z'\n      },\n      {\n        id: 6,\n        sender_id: 2,\n        content: '面试准备的资料我发给你了',\n        message_type: 'text',\n        created_at: '2024-07-24T10:15:00Z'\n      }\n    ],\n    3: [\n      {\n        id: 7,\n        sender_id: 3,\n        content: '申请材料看起来不错，有几个地方可以优化',\n        message_type: 'text',\n        created_at: '2024-07-23T16:45:00Z'\n      }\n    ]\n  };\n\n  useEffect(() => {\n    setChatRooms(mockChatRooms);\n    // 默认选择第一个聊天室\n    if (mockChatRooms.length > 0) {\n      setSelectedRoom(mockChatRooms[0]);\n      setMessages(mockMessages[mockChatRooms[0].id] || []);\n    }\n  }, []);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const handleRoomSelect = (room) => {\n    setSelectedRoom(room);\n    setMessages(mockMessages[room.id] || []);\n    \n    // 标记消息为已读\n    setChatRooms(prev => prev.map(r => \n      r.id === room.id ? { ...r, unread_count: 0 } : r\n    ));\n  };\n\n  const handleSendMessage = () => {\n    if (!message.trim() || !selectedRoom) return;\n\n    const newMessage = {\n      id: Date.now(),\n      sender_id: 999, // 当前用户ID\n      content: message,\n      message_type: 'text',\n      created_at: new Date().toISOString()\n    };\n\n    setMessages(prev => [...prev, newMessage]);\n    setMessage('');\n\n    // 更新聊天室的最后消息\n    setChatRooms(prev => prev.map(room => \n      room.id === selectedRoom.id \n        ? { \n            ...room, \n            last_message: {\n              content: message,\n              sender_id: 999,\n              created_at: new Date().toISOString()\n            },\n            updated_at: new Date().toISOString()\n          }\n        : room\n    ));\n  };\n\n  const formatTime = (dateString) => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffInMinutes = Math.floor((now - date) / (1000 * 60));\n    \n    if (diffInMinutes < 1) return '刚刚';\n    if (diffInMinutes < 60) return `${diffInMinutes}分钟前`;\n    if (diffInMinutes < 1440) return `${Math.floor(diffInMinutes / 60)}小时前`;\n    return date.toLocaleDateString();\n  };\n\n  const getOnlineStatusColor = (status) => {\n    switch (status) {\n      case 'online': return 'success';\n      case 'away': return 'warning';\n      case 'offline': return 'error';\n      default: return 'default';\n    }\n  };\n\n  const filteredRooms = chatRooms.filter(room =>\n    room.other_user.full_name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    room.other_user.username.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  return (\n    <Container maxWidth=\"xl\" sx={{ py: 2, height: '100vh' }}>\n      <Grid container spacing={2} sx={{ height: 'calc(100vh - 32px)' }}>\n        {/* 聊天列表侧边栏 */}\n        <Grid item xs={12} md={4} lg={3}>\n          <Card sx={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n            {/* 头部 */}\n            <Box sx={{ p: 2, borderBottom: 1, borderColor: 'divider' }}>\n              <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n                <Typography variant=\"h6\">消息</Typography>\n                <Box>\n                  <IconButton\n                    onClick={() => setAiChatOpen(true)}\n                    sx={{ \n                      background: 'linear-gradient(45deg, #ff6b6b, #ffa500)',\n                      color: 'white',\n                      mr: 1,\n                      '&:hover': {\n                        background: 'linear-gradient(45deg, #ff5252, #ff9800)',\n                      }\n                    }}\n                    size=\"small\"\n                  >\n                    <AIIcon />\n                  </IconButton>\n                  <IconButton>\n                    <AddIcon />\n                  </IconButton>\n                </Box>\n              </Box>\n              \n              {/* 搜索框 */}\n              <TextField\n                fullWidth\n                size=\"small\"\n                placeholder=\"搜索联系人...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                InputProps={{\n                  startAdornment: <SearchIcon sx={{ color: 'text.secondary', mr: 1 }} />\n                }}\n              />\n            </Box>\n\n            {/* 聊天室列表 */}\n            <Box sx={{ flex: 1, overflow: 'auto' }}>\n              <List sx={{ p: 0 }}>\n                {filteredRooms.map((room) => (\n                  <ListItem\n                    key={room.id}\n                    button\n                    selected={selectedRoom?.id === room.id}\n                    onClick={() => handleRoomSelect(room)}\n                    sx={{\n                      borderBottom: 1,\n                      borderColor: 'divider',\n                      '&.Mui-selected': {\n                        backgroundColor: 'primary.light',\n                        '&:hover': {\n                          backgroundColor: 'primary.light',\n                        }\n                      }\n                    }}\n                  >\n                    <ListItemAvatar>\n                      <Badge\n                        color={getOnlineStatusColor(room.other_user.online_status)}\n                        variant=\"dot\"\n                        invisible={room.other_user.online_status === 'offline'}\n                        anchorOrigin={{\n                          vertical: 'bottom',\n                          horizontal: 'right',\n                        }}\n                      >\n                        <Avatar src={room.other_user.avatar_url} />\n                      </Badge>\n                    </ListItemAvatar>\n                    <ListItemText\n                      primary={\n                        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                          <Typography variant=\"subtitle2\" noWrap>\n                            {room.other_user.full_name}\n                          </Typography>\n                          {room.unread_count > 0 && (\n                            <Badge badgeContent={room.unread_count} color=\"error\" />\n                          )}\n                        </Box>\n                      }\n                      secondary={\n                        <Box>\n                          <Typography\n                            variant=\"body2\"\n                            color=\"text.secondary\"\n                            noWrap\n                            sx={{ mb: 0.5 }}\n                          >\n                            {room.last_message?.content || '暂无消息'}\n                          </Typography>\n                          <Typography variant=\"caption\" color=\"text.secondary\">\n                            {formatTime(room.last_message?.created_at || room.updated_at)}\n                          </Typography>\n                        </Box>\n                      }\n                    />\n                  </ListItem>\n                ))}\n              </List>\n            </Box>\n          </Card>\n        </Grid>\n\n        {/* 聊天区域 */}\n        <Grid item xs={12} md={8} lg={9}>\n          {selectedRoom ? (\n            <Card sx={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n              {/* 聊天头部 */}\n              <Box sx={{ p: 2, borderBottom: 1, borderColor: 'divider' }}>\n                <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                  <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n                    <Badge\n                      color={getOnlineStatusColor(selectedRoom.other_user.online_status)}\n                      variant=\"dot\"\n                      invisible={selectedRoom.other_user.online_status === 'offline'}\n                    >\n                      <Avatar src={selectedRoom.other_user.avatar_url} />\n                    </Badge>\n                    <Box>\n                      <Typography variant=\"h6\">\n                        {selectedRoom.other_user.full_name}\n                      </Typography>\n                      <Typography variant=\"body2\" color=\"text.secondary\">\n                        {selectedRoom.other_user.online_status === 'online'\n                          ? '在线'\n                          : selectedRoom.other_user.online_status === 'away'\n                          ? '离开'\n                          : `最后上线: ${formatTime(selectedRoom.other_user.last_seen)}`\n                        }\n                      </Typography>\n                    </Box>\n                  </Box>\n                  <Box>\n                    <IconButton>\n                      <PhoneIcon />\n                    </IconButton>\n                    <IconButton>\n                      <VideoCallIcon />\n                    </IconButton>\n                    <IconButton>\n                      <InfoIcon />\n                    </IconButton>\n                    <IconButton>\n                      <MoreVertIcon />\n                    </IconButton>\n                  </Box>\n                </Box>\n              </Box>\n\n              {/* 消息区域 */}\n              <Box sx={{ flex: 1, overflow: 'auto', p: 1 }}>\n                {messages.map((msg) => (\n                  <Box\n                    key={msg.id}\n                    sx={{\n                      display: 'flex',\n                      justifyContent: msg.sender_id === 999 ? 'flex-end' : 'flex-start',\n                      mb: 1\n                    }}\n                  >\n                    <Box\n                      sx={{\n                        maxWidth: '70%',\n                        display: 'flex',\n                        flexDirection: msg.sender_id === 999 ? 'row-reverse' : 'row',\n                        alignItems: 'flex-end',\n                        gap: 1\n                      }}\n                    >\n                      {msg.sender_id !== 999 && (\n                        <Avatar\n                          src={selectedRoom.other_user.avatar_url}\n                          sx={{ width: 32, height: 32 }}\n                        />\n                      )}\n                      <Paper\n                        sx={{\n                          p: 1.5,\n                          backgroundColor: msg.sender_id === 999 ? 'primary.main' : 'grey.100',\n                          color: msg.sender_id === 999 ? 'white' : 'text.primary',\n                          borderRadius: 2,\n                          borderBottomRightRadius: msg.sender_id === 999 ? 4 : 16,\n                          borderBottomLeftRadius: msg.sender_id === 999 ? 16 : 4,\n                        }}\n                      >\n                        <Typography variant=\"body2\">\n                          {msg.content}\n                        </Typography>\n                        <Typography\n                          variant=\"caption\"\n                          sx={{\n                            display: 'block',\n                            mt: 0.5,\n                            opacity: 0.7,\n                            fontSize: '0.75rem'\n                          }}\n                        >\n                          {new Date(msg.created_at).toLocaleTimeString([], {\n                            hour: '2-digit',\n                            minute: '2-digit'\n                          })}\n                        </Typography>\n                      </Paper>\n                    </Box>\n                  </Box>\n                ))}\n                <div ref={messagesEndRef} />\n              </Box>\n\n              {/* 输入区域 */}\n              <Box sx={{ p: 2, borderTop: 1, borderColor: 'divider' }}>\n                <Box sx={{ display: 'flex', gap: 1, alignItems: 'flex-end' }}>\n                  <IconButton>\n                    <AttachFileIcon />\n                  </IconButton>\n                  <IconButton>\n                    <EmojiIcon />\n                  </IconButton>\n                  <TextField\n                    fullWidth\n                    multiline\n                    maxRows={4}\n                    placeholder=\"输入消息...\"\n                    value={message}\n                    onChange={(e) => setMessage(e.target.value)}\n                    onKeyPress={(e) => {\n                      if (e.key === 'Enter' && !e.shiftKey) {\n                        e.preventDefault();\n                        handleSendMessage();\n                      }\n                    }}\n                    variant=\"outlined\"\n                    size=\"small\"\n                  />\n                  <IconButton\n                    color=\"primary\"\n                    onClick={handleSendMessage}\n                    disabled={!message.trim()}\n                  >\n                    <SendIcon />\n                  </IconButton>\n                </Box>\n              </Box>\n            </Card>\n          ) : (\n            <Card sx={{ height: '100%', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n              <Box sx={{ textAlign: 'center' }}>\n                <Typography variant=\"h6\" color=\"text.secondary\" gutterBottom>\n                  选择一个对话开始聊天\n                </Typography>\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  或者\n                </Typography>\n                <Button\n                  variant=\"contained\"\n                  startIcon={<AIIcon />}\n                  onClick={() => setAiChatOpen(true)}\n                  sx={{\n                    mt: 2,\n                    background: 'linear-gradient(45deg, #ff6b6b, #ffa500)',\n                    '&:hover': {\n                      background: 'linear-gradient(45deg, #ff5252, #ff9800)',\n                    }\n                  }}\n                >\n                  与AI助手聊天\n                </Button>\n              </Box>\n            </Card>\n          )}\n        </Grid>\n      </Grid>\n\n      {/* AI聊天对话框 */}\n      <Dialog\n        open={aiChatOpen}\n        onClose={() => setAiChatOpen(false)}\n        maxWidth=\"md\"\n        fullWidth\n        PaperProps={{\n          sx: {\n            height: '80vh',\n            borderRadius: 3\n          }\n        }}\n      >\n        <DialogTitle sx={{ \n          background: 'linear-gradient(45deg, #ff6b6b, #ffa500)',\n          color: 'white',\n          display: 'flex',\n          alignItems: 'center',\n          gap: 1\n        }}>\n          <AIIcon />\n          AI留学咨询助手\n        </DialogTitle>\n        <DialogContent sx={{ p: 0, height: '100%' }}>\n          <AIConsultationChat />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setAiChatOpen(false)}>关闭</Button>\n        </DialogActions>\n      </Dialog>\n    </Container>\n  );\n};\n\nexport default ChatPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}